---
title: 博客及相关服务部署更新
author: johnpoint
date: 2022-04-17 00:40:00
tags:
- cloudflare
- 自动构建
- 折腾
toc: true
---

## 部署流程更新

~~众所周知~~，之前我的博客以及图片托管的服务是通过硬核的DNS分区域解析来实现流量的就近调度，而多个服务器之间的资源文件我一般使用syncthing来进行同步，这个方法显得比较粗糙，但是还挺有效的。最近折腾了下 cloudflare worker 感觉还不错，于是就把博客以及图片托管迁移到了 cloudflare worker 上来，这样一来可以白嫖到不错的全球加速(除中国大陆)，而且使用 workers 进行部署可以省下不少的服务器资源。

这个就是我之前的发布工作流程

![](https://cdn.6-d.cc/img/20220417004.jpg)

在这次部署流程更新后他变成了这样，博客由于是 public 代码仓库，所以我的自动构建直接使用了 github action，只要基于之前的配置改改加上 publish 到 cloudflare workers 的 step 就可以直接用了。

![](https://cdn.6-d.cc/img/20220417002.jpg)

而静态文件托管的我一直是存在自建的 gitea 上面，所以配了个 drone 来执行自动 publish 到 cloudflare workers 的工作，总而言之也是挺香的。

![](https://cdn.6-d.cc/img/20220417003.jpg)

## 博客主题更新

博客主题也好久没有更新了，这次更新主要是加上了几个能够改进访问体验的 feature。

- 添加了首页巨幕以及文章头图图片下面的背景颜色，能够自定义在图片还没有加载出来之前显示的颜色
- 将博客底部版权信息部分的版本号放进了一个js里面，这样就减少了版本号修改时候需要修改的位置
- 将原来的文章无头图从几张图片中随机选择一张作为头图改成了随机选择一个颜色作为头图

颜色随机取值这里，是取值RGB都在 110-87之间的值，这里的颜色饱和度比较低，看起来比较舒服


