language: node_js
node_js: 13
branches:
  only:
  - source
cache:
  apt: true
  directories:
    - node_modules
before_install:
- git config --global user.name "johnpoint"
- git config --global user.email "me@lvcshu.com"
- npm install -g hexo-cli
script:
- cd themes && git clone https://github.com/johnpoint/hexo-theme-XvA XvA && mv _config.yml XvA/ && mv zh-Cu.yml XvA/languages
- npm install hexo-generator-feed hexo-neat --save
- hexo clean
- hexo generate
after_success:
- cd ../
- mkdir push
- cd ./push
- git clone https://github.com/johnpoint/johnpoint.github.io .
- rm * -rf
- cp ../public/* . -r
- git add --all .
- git commit -m "Travis CI Auto Build"
- git push --quiet https://$REPO_TOKEN@github.com/johnpoint/johnpoint.github.io
  master
